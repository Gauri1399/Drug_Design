# ðŸ§¬ Protein-Ligand Binding Prediction with Pocket Detection

## Project Overview
This project integrates **protein structure analysis** and **AI-based ligand binding prediction** to identify active and allosteric binding sites and predict binding affinities for small molecules. It combines **structural bioinformatics** (PDB analysis, cavity/pocket detection) with **machine learning / deep learning** (DeepAffinity) to provide a complete ligand screening workflow.

---

## Workflow

### Step 1: Protein Pocket Analysis
- Load protein structures from **PDB files**.
- Calculate **molecular surfaces** and detect **cavities/pockets**.
- Extract cavity features: **volume, depth, enclosure, center coordinates**.
- Compute **pocket-likeness scores** to classify cavities as potential binding pockets.
- Load datasets of **catalytic residues** and **active sites** to classify pockets as:
  - **ACTIVE**
  - **ALLOSTERIC**
  - **UNKNOWN**

### Step 2: Protein & Ligand Selection
- Select protein based on structural criteria (resolution, ligand binding site availability).
- Query **PubChem** for ligands using keywords and apply **Lipinski's Rule of 5**.
- Fetch ligand structures and compute features.

### Step 3: DeepAffinity Model â€“ AI-based Binding Prediction
- **Initialize pretrained DeepAffinity model** (Karimi et al., 2019).
- Encode protein sequences and ligand SMILES using model encoders (BiLSTM/CNN for protein, GCN/RNN for ligand).
- Prepare training dataset from **BindingDB** or PubChem-PDB pairs.
- Train DeepAffinity to predict binding affinities.
- Predict binding scores for selected protein-ligand pairs.

### Step 4: Results Analysis
- Store predicted binding affinities in `predicted_binding_affinities.csv`.
- Visualize binding scores using bar charts.
- Identify ligands with highest predicted binding to target protein pockets.

---

## Features
- Detect protein cavities and classify them as active/allosteric sites.
- Select ligands based on structural and drug-like criteria.
- Use **AI (DeepAffinity)** to predict binding affinities.
- Combine bioinformatics and cheminformatics workflows.
- Output CSV for binding scores and bar chart visualizations.

---

## Installation
Requires Python 3.x and the following libraries:

```bash
pip install rdkit biopandas numpy pandas matplotlib scikit-learn requests
